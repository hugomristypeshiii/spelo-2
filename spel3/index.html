<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8">
<title>Rybergs Slott Deluxe</title>

<style>
body{
    margin:0;
    background:radial-gradient(circle,#140022,#000);
    font-family:Arial;
    color:white;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
}

.wrapper{
    text-align:center;
    padding:35px;
    background:#120018;
    border-radius:20px;
    box-shadow:0 0 60px #ff00ff40;
}

/* NAMNET L√ÑNGRE NER */
h1{
    margin-top:20px;
    margin-bottom:25px;
    color:gold;
    text-shadow:0 0 12px gold;
}

#grid{
    display:grid;
    grid-template-columns:repeat(4,85px);
    grid-template-rows:repeat(4,85px);
    gap:12px;
    margin:20px auto;
}

.cell{
    display:flex;
    justify-content:center;
    align-items:center;
    font-size:46px;
    border-radius:14px;
    background:linear-gradient(#2b003b,#150020);
    box-shadow:inset 0 0 10px black;
    transition:transform .15s;
}

.win{
    animation:flash .4s infinite;
}
@keyframes flash{
    50%{box-shadow:0 0 25px gold;}
}

button{
    padding:10px 22px;
    border:none;
    border-radius:10px;
    font-weight:bold;
    cursor:pointer;
    margin:6px;
}

.spin{background:#00ffe7;}
.bonus{background:#ff9900;}
.home{background:#ff5555;}

input{
    width:90px;
    text-align:center;
}

.winText{
    height:30px;
    margin:10px;
    font-size:24px;
    color:#ffe600;
}

/* bonus glow */
.bonusMode{
    box-shadow:0 0 80px #ff00ff;
    background:radial-gradient(circle,#3b0057,#110011);
}
</style>
</head>

<body>

<div class="wrapper" id="wrapper">

<h1>üè∞ Rybergs Slott Deluxe</h1>

Satsning:
<input id="betInput" type="number" value="100" min="10" max="1000">

<div id="grid"></div>

<div class="winText" id="winText"></div>

<button class="spin" onclick="spin()">üé∞ Snurra</button>
<button class="bonus" onclick="buyBonus()">üíé Bonus (10 spins)</button>
<button class="home" onclick="goHome()">‚Üê Tillbaka</button>

<div>Saldo: <span id="money">1000</span> kr</div>

</div>

<script>
const SIZE=4;
const symbols=["üíé","üëë","üçÄ","‚≠ê","üè∞","üó°Ô∏è"];

let grid=[];
let money=1000;
let spinning=false;

let bonusSpins=0;

const gridEl=document.getElementById("grid");
const moneyEl=document.getElementById("money");
const winText=document.getElementById("winText");
const wrapper=document.getElementById("wrapper");
const betInput=document.getElementById("betInput");


// ---------- INIT ----------
function createGrid(){
    gridEl.innerHTML="";
    for(let r=0;r<SIZE;r++){
        grid[r]=[];
        for(let c=0;c<SIZE;c++){
            let d=document.createElement("div");
            d.className="cell";
            d.dataset.r=r;
            d.dataset.c=c;
            gridEl.appendChild(d);
            grid[r][c]=rand();
        }
    }
    render();
}

function rand(){
    return symbols[Math.floor(Math.random()*symbols.length)];
}

function render(){
    document.querySelectorAll(".cell").forEach(cell=>{
        let r=cell.dataset.r;
        let c=cell.dataset.c;
        cell.textContent=grid[r][c];
        cell.classList.remove("win");
    });
}


// ---------- WIN CHECK ----------
function checkWins(){
    let lines=[];

    for(let r=0;r<SIZE;r++)
        if(new Set(grid[r]).size===1)
            lines.push(grid[r].map((_,i)=>[r,i]));

    for(let c=0;c<SIZE;c++){
        let col=[grid[0][c],grid[1][c],grid[2][c],grid[3][c]];
        if(new Set(col).size===1)
            lines.push([[0,c],[1,c],[2,c],[3,c]]);
    }

    return lines;
}


// ---------- SPIN ----------
function spin(){

    if(spinning) return;

    let bet=parseInt(betInput.value)||100;

    if(money<bet){
        alert("Inte tillr√§ckligt med pengar!");
        return;
    }

    spinning=true;

    money-=bet;
    moneyEl.textContent=money;
    winText.textContent="";

    // nya symboler
    for(let r=0;r<SIZE;r++)
        for(let c=0;c<SIZE;c++)
            grid[r][c]=rand();

    render();

    setTimeout(()=>{

        let wins=checkWins();
        let totalWin=0;

        wins.forEach(line=>{
            line.forEach(([r,c])=>{
                document.querySelector(`[data-r='${r}'][data-c='${c}']`).classList.add("win");
            });

            let mult = bonusSpins>0
                ? Math.floor(Math.random()*8)+3  // 3-10x
                : Math.floor(Math.random()*4)+2; // 2-5x

            totalWin+=bet*mult;
        });

        // bonus garanti
        if(bonusSpins>0 && totalWin<bet*0.2)
            totalWin=bet*0.2;

        money+=totalWin;
        moneyEl.textContent=money;

        if(totalWin>=bet*8) winText.textContent="üéâ MEGA WIN!";
        else if(totalWin>=bet*4) winText.textContent="‚ú® BIG WIN!";
        else if(totalWin>0) winText.textContent="WIN!";

        spinning=false;

        // bonus auto
        if(bonusSpins>0){
            bonusSpins--;
            if(bonusSpins>0)
                setTimeout(spin,600);
            else
                wrapper.classList.remove("bonusMode");
        }

    },200);
}


// ---------- BONUS ----------
function buyBonus(){
    let bet=parseInt(betInput.value)||100;

    if(bet<200){
        alert("Minst 200 kr!");
        return;
    }

    bonusSpins=10;
    wrapper.classList.add("bonusMode");
    spin();
}


// ---------- NAV ----------
function goHome(){
    window.location.href="../index.html";
}


createGrid();
</script>
</body>
</html>
