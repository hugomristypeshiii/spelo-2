<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8" />
<title>üè∞ Rybergs Slott Deluxe</title>

<style>
body{
    margin:0;
    font-family:Arial;
    background:radial-gradient(circle,#120022,#000);
    color:white;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
}

/* ---------- LAYOUT ---------- */

.wrapper{
    text-align:center;
    padding:25px;
    border-radius:20px;
    background:linear-gradient(180deg,#1b0033,#0a0015);
    box-shadow:0 0 60px #ff00ff40;
}

h1{
    color:#ffd700;
    text-shadow:0 0 15px gold;
}

#grid{
    margin:25px auto;
    display:grid;
    grid-template-columns:repeat(4,85px);
    grid-template-rows:repeat(4,85px);
    gap:12px;
}

/* ---------- CELLS ---------- */

.cell{
    display:flex;
    justify-content:center;
    align-items:center;
    font-size:48px;
    border-radius:14px;
    background:linear-gradient(180deg,#2a003d,#150020);
    box-shadow:inset 0 0 10px #000, 0 0 6px #ff00ff30;
    transition:transform .12s linear;
}

.win{
    animation:flash .45s infinite;
}
@keyframes flash{
    0%,100%{box-shadow:0 0 10px gold;}
    50%{box-shadow:0 0 35px gold;}
}

/* ---------- BUTTONS ---------- */

button{
    padding:10px 22px;
    border:none;
    border-radius:10px;
    font-weight:bold;
    cursor:pointer;
    margin:5px;
}

.spin{background:#00ffe7;}
.bonus{background:#ff9900;}
.home{background:#ff5555;}

input{
    width:90px;
    padding:6px;
    border-radius:6px;
    border:none;
    text-align:center;
}

/* ---------- BONUS MODE ---------- */

.bonusMode{
    background:radial-gradient(circle,#440066,#110011);
    box-shadow:0 0 80px #ff00ff;
}

/* ---------- TEXT ---------- */

.winText{
    font-size:26px;
    height:32px;
    margin:8px;
    color:#ffe600;
    text-shadow:0 0 15px #ffe600;
}

.stats{
    margin-top:10px;
}
</style>
</head>
<body>

<div class="wrapper" id="wrapper">

<h1>üè∞ Rybergs Slott Deluxe</h1>

Satsning:
<input type="number" id="bet" value="100" min="10" max="1000">

<div id="grid"></div>

<div class="winText" id="winText"></div>

<button class="spin" onclick="spin(false)">üé∞ Snurra</button>
<button class="bonus" onclick="buyBonus()">üíé Bonus (10 spins)</button>
<button class="home" onclick="goHome()">‚Üê Tillbaka</button>

<div class="stats">
Saldo: <span id="money">1000</span> kr
</div>

</div>


<script>
const SIZE = 4;
const symbols = ["üíé","üëë","üçÄ","‚≠ê","üè∞","üó°Ô∏è"];

let grid = [];
let money = 1000;
let spinning = false;

let bonusSpins = 0;
let bonusMode = false;

const gridEl = document.getElementById("grid");
const moneyEl = document.getElementById("money");
const winText = document.getElementById("winText");
const wrapper = document.getElementById("wrapper");


// ---------- INIT ----------
function createGrid(){
    gridEl.innerHTML="";
    for(let r=0;r<SIZE;r++){
        grid[r]=[];
        for(let c=0;c<SIZE;c++){
            const cell=document.createElement("div");
            cell.className="cell";
            cell.dataset.r=r;
            cell.dataset.c=c;
            gridEl.appendChild(cell);
            grid[r][c]=rand();
        }
    }
    render();
}

function rand(){
    return symbols[Math.floor(Math.random()*symbols.length)];
}

function render(){
    document.querySelectorAll(".cell").forEach(cell=>{
        const r=cell.dataset.r;
        const c=cell.dataset.c;
        cell.textContent = grid[r][c];
        cell.classList.remove("win");
    });
}


// ---------- SMOOTH DROP (pro feel) ----------
function dropAnimation(done){
    let steps = 12;
    let count = 0;

    function frame(){
        document.querySelectorAll(".cell").forEach(cell=>{
            cell.style.transform=`translateY(${(steps-count)*6}px)`;
        });

        count++;
        if(count<steps) requestAnimationFrame(frame);
        else{
            document.querySelectorAll(".cell").forEach(c=>c.style.transform="translateY(0)");
            done();
        }
    }
    frame();
}


// ---------- WIN CHECK ----------
function checkWins(){
    let wins=[];

    for(let r=0;r<SIZE;r++){
        if(new Set(grid[r]).size===1) wins.push(grid[r].map((_,i)=>[r,i]));
    }

    for(let c=0;c<SIZE;c++){
        let col=[grid[0][c],grid[1][c],grid[2][c],grid[3][c]];
        if(new Set(col).size===1) wins.push([[0,c],[1,c],[2,c],[3,c]]);
    }

    return wins;
}


// ---------- SPIN ----------
function spin(isBonus){

    if(spinning) return;

    let bet = parseInt(bet.value);
    if(money < bet){ alert("Inte tillr√§ckligt!"); return;}

    spinning=true;
    money -= bet;
    moneyEl.textContent = money;
    winText.textContent="";

    // slumpa nya symboler
    for(let r=0;r<SIZE;r++)
        for(let c=0;c<SIZE;c++)
            grid[r][c]=rand();

    dropAnimation(()=>{

        render();

        let wins = checkWins();
        let totalWin = 0;

        wins.forEach(line=>{
            line.forEach(([r,c])=>{
                document.querySelector(`[data-r='${r}'][data-c='${c}']`).classList.add("win");
            });

            let mult = isBonus
                ? Math.floor(Math.random()*8)+3   // 3-10x
                : Math.floor(Math.random()*4)+2;  // 2-5x

            totalWin += bet*mult;
        });

        if(isBonus && totalWin < bet*0.2)
            totalWin = bet*0.2;

        money += totalWin;
        moneyEl.textContent = money;

        if(totalWin >= bet*8) winText.textContent="üéâ MEGA WIN!";
        else if(totalWin >= bet*4) winText.textContent="‚ú® BIG WIN!";
        else if(totalWin>0) winText.textContent="WIN!";

        spinning=false;

        // BONUS AUTO SPINS
        if(bonusMode){
            bonusSpins--;
            if(bonusSpins>0){
                setTimeout(()=>spin(true),700);
            }else{
                bonusMode=false;
                wrapper.classList.remove("bonusMode");
            }
        }

    });
}


// ---------- BONUS ----------
function buyBonus(){
    let bet = parseInt(betInput.value || 100);
    if(bet < 200){ alert("Minst 200 kr f√∂r bonus!"); return; }

    bonusMode=true;
    bonusSpins=10;

    wrapper.classList.add("bonusMode");

    spin(true);
}


// ---------- NAV ----------
function goHome(){
    window.location.href="../index.html";
}


// ---------- START ----------
createGrid();
</script>

</body>
</html>
