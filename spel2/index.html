<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Star Blaster ðŸš€</title>

<style>
body {
    margin: 0;
    background: radial-gradient(circle at top, #0a0a18, #020208);
    overflow: hidden;
    font-family: Arial, sans-serif;
    color: white;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
}

.wrapper {
    position: relative;
    text-align: center;
}

h1 {
    color: #00ffe7;
    text-shadow: 0 0 20px #00ffe7;
}

canvas {
    background: black;
    border-radius: 20px;
    box-shadow: 0 0 40px #00ffe7;
}

.ui {
    margin: 10px 0;
}

/* Game over */
.overlay {
    position: absolute;
    inset: 0;
    display: none;
    background: rgba(0,0,0,0.8);
    justify-content: center;
    align-items: center;
    flex-direction: column;
    border-radius: 20px;
}

.overlay h2 {
    color: #ff2e88;
    font-size: 2.5rem;
    text-shadow: 0 0 20px #ff2e88;
}

button {
    margin-top: 15px;
    padding: 12px 25px;
    border-radius: 10px;
    border: none;
    background: #00ffe7;
    font-weight: bold;
    cursor: pointer;
}
</style>
</head>

<body>

<div class="wrapper">
    <h1>ðŸš€ Star Blaster</h1>

    <div class="ui">
        Score: <span id="score">0</span> |
        Liv: <span id="lives">3</span>
    </div>

    <canvas id="game" width="500" height="600"></canvas>

    <div class="overlay" id="overlay">
        <h2>ðŸ’€ GAME OVER</h2>
        <button onclick="restart()">Spela igen</button>
    </div>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let player, bullets, enemies, keys, score, lives, running;

const scoreEl = document.getElementById("score");
const livesEl = document.getElementById("lives");
const overlay = document.getElementById("overlay");

function init() {
    player = {x:250, y:540, w:40, h:40, speed:6};
    bullets = [];
    enemies = [];
    keys = {};
    score = 0;
    lives = 3;
    running = true;

    scoreEl.textContent = score;
    livesEl.textContent = lives;
    overlay.style.display = "none";
}

function spawnEnemy() {
    enemies.push({
        x: Math.random()*460,
        y: -30,
        w: 30,
        h: 30,
        speed: 2 + Math.random()*2
    });
}

function drawShip() {
    ctx.fillStyle = "#00ffe7";
    ctx.shadowBlur = 20;
    ctx.shadowColor = "#00ffe7";

    ctx.beginPath();
    ctx.moveTo(player.x+20, player.y);
    ctx.lineTo(player.x, player.y+40);
    ctx.lineTo(player.x+40, player.y+40);
    ctx.fill();

    ctx.shadowBlur = 0;
}

function drawRect(o, color, glow=0) {
    ctx.fillStyle = color;
    ctx.shadowBlur = glow;
    ctx.shadowColor = color;
    ctx.fillRect(o.x, o.y, o.w, o.h);
    ctx.shadowBlur = 0;
}

function update() {
    if(!running) return;

    // movement
    if(keys["ArrowLeft"] || keys["a"]) player.x -= player.speed;
    if(keys["ArrowRight"] || keys["d"]) player.x += player.speed;

    player.x = Math.max(0, Math.min(canvas.width-player.w, player.x));

    // bullets
    bullets.forEach(b => b.y -= 8);
    bullets = bullets.filter(b => b.y > -20);

    // enemies
    enemies.forEach(e => e.y += e.speed);

    // collision
    bullets.forEach((b, bi) => {
        enemies.forEach((e, ei) => {
            if(b.x < e.x+e.w && b.x+4 > e.x &&
               b.y < e.y+e.h && b.y+10 > e.y) {
                enemies.splice(ei,1);
                bullets.splice(bi,1);
                score += 10;
                scoreEl.textContent = score;
            }
        });
    });

    // enemy hits player
    enemies.forEach((e, i) => {
        if(e.y+e.h > player.y &&
           e.x < player.x+player.w &&
           e.x+e.w > player.x) {
            enemies.splice(i,1);
            lives--;
            livesEl.textContent = lives;
            if(lives <= 0) gameOver();
        }
    });

    enemies = enemies.filter(e => e.y < canvas.height+40);
}

function drawStars() {
    for(let i=0;i<60;i++){
        ctx.fillStyle = "white";
        ctx.fillRect(Math.random()*500, Math.random()*600, 2, 2);
    }
}

function draw() {
    ctx.fillStyle = "black";
    ctx.fillRect(0,0,canvas.width,canvas.height);

    drawStars();

    drawShip();

    bullets.forEach(b => drawRect(b, "#ff2e88", 10));
    enemies.forEach(e => drawRect(e, "#8a2eff", 15));
}

function loop() {
    update();
    draw();
    requestAnimationFrame(loop);
}

function shoot() {
    bullets.push({x: player.x+18, y: player.y, w:4, h:10});
}

function gameOver() {
    running = false;
    overlay.style.display = "flex";
}

function restart() {
    init();
}

document.addEventListener("keydown", e=>{
    keys[e.key] = true;
    if(e.key === " ") shoot();
});
document.addEventListener("keyup", e=> keys[e.key]=false);

setInterval(spawnEnemy, 800);

init();
loop();
</script>

</body>
</html>
